# Load necessary libraries
library(stringr)

# Read the script text into R
script_text <- readLines("script.txt")

# Tokenization: Split the text into words
words <- unlist(str_split(script_text, "\\s+"))  # Split by whitespace

# Vocabulary Richness: Calculate type-token ratio (TTR)
unique_words <- unique(words)
ttr <- length(unique_words) / length(words)

# Sentence Length: Calculate average sentence length
sentences <- str_extract_all(script_text, "\\b\\w+\\b.*?[.!?](?=\\s|$)")
sentence_lengths <- sapply(sentences, function(x) length(unlist(str_split(x, "\\s+"))))  # Count words per sentence
avg_sentence_length <- mean(sentence_lengths)

# Readability Metrics: Compute Flesch-Kincaid Grade Level
words_per_sentence <- sum(sentence_lengths) / length(sentences)
syllables_per_word <- sum(sapply(words, function(x) syllable::syllable_count(x))) / length(words)
flesch_kincaid_grade_level <- 0.39 * words_per_sentence + 11.8 * syllables_per_word - 15.59

# Display results
print(paste("Type-Token Ratio (TTR):", round(ttr, 2)))
print(paste("Average Sentence Length:", round(avg_sentence_length, 2)))
print(paste("Flesch-Kincaid Grade Level:", round(flesch_kincaid_grade_level, 2)))
